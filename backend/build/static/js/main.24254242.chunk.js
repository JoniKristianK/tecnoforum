(this.webpackJsonptecnoforum=this.webpackJsonptecnoforum||[]).push([[0],{68:function(e,t,a){e.exports=a(78)},78:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(11),c=a.n(o),i=a(30),s=Object(r.createContext)(),l=function(e){var t=e.reducer,a=e.initialState,o=e.children;return n.a.createElement(s.Provider,{value:Object(r.useReducer)(t,a)},o)},u=function(){return Object(r.useContext)(s)},m=a(7),g=function(e){return{type:"LOGIN_SUCCESS",data:e}},d=function(e){return{type:"LOGIN_FAILED",error:e}},E=function(){return{type:"LOGOUT_SUCCESS"}},b=function(e){return{type:"LOGOUT_FAILED"}},p=function(){if(sessionStorage.getItem("loginstate")){var e=JSON.parse(sessionStorage.getItem("loginstate"));return e.error="",e}return{token:"",user:{},isLogged:!1,error:""}}(),f=function(e,t){console.log("LoginReducer, action:",t);var a={};switch(t.type){case"LOGIN_SUCCESS":a={isLogged:!0,token:t.data.token,user:t.data.user,error:"",loading:!1};break;case"LOGIN_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"LOGOUT_SUCCESS":a={isLogged:!1,token:"",user:{},error:""};break;case"LOGOUT_FAILED":a={isLogged:!1,token:"",user:{},error:t.error};break;default:return e}return sessionStorage.setItem("loginstate",JSON.stringify(a)),a},h=function(){return{type:"REGISTER_SUCCESS"}},O=function(e){return{type:"REGISTER_FAILED",error:e}},S=function(){if(sessionStorage.getItem("registerstate")){var e=JSON.parse(sessionStorage.getItem("registerstate"));return e.error="",e.success=!1,e}return{error:"",success:!1}}(),C=function(e,t){console.log("RegisterReducer, action:",t);var a={};switch(t.type){case"REGISTER_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{error:"",success:!0});break;case"REGISTER_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error,success:!1});break;default:return e}return sessionStorage.setItem("registerstate",JSON.stringify(a)),a},v=function(e){return{type:"FETCH_CATEGORIES_SUCCESS",categories:e}},j=function(e){return{type:"FETCH_CATEGORIES_FAILED",error:e}},y=function(){if(sessionStorage.getItem("categorystate")){var e=JSON.parse(sessionStorage.getItem("categorystate"));return e.error="",e}return{threads:null,category:null,categories:[],error:""}}(),k=function(e,t){console.log("CategoryReducer, action:",t);var a={};switch(t.type){case"FETCH_CATEGORIES_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{categories:t.categories,error:""});break;case"FETCH_CATEGORIES_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"FETCH_CATEGORY_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{category:t.category,error:""});break;case"FETCH_CATEGORY_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"FETCH_THREADS_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{threads:t.threads,error:""});break;case"FETCH_THREADS_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"ADD_CATEGORY_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{error:""});break;case"ADD_CATEGORY_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"REMOVE_CATEGORY_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{error:""});break;case"REMOVE_CATEGORY_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"EDIT_CATEGORY_SUCCESS":a=Object(m.a)(Object(m.a)({},e),{},{error:""});break;case"EDIT_CATEGORY_FAILED":a=Object(m.a)(Object(m.a)({},e),{},{error:t.error});break;case"CLEAR_THREADS":a=Object(m.a)(Object(m.a)({},e),{},{threads:null,error:""});break;default:return e}return sessionStorage.setItem("categorystate",JSON.stringify(a)),a},L={login:p,register:S,category:y},w=a(20),_=a(13),T=a(126),I=a(114),R=a(118),A=a(81),x=a(119),F=a(43),N=a(128),G=a(115),D=a(129),B=a(117),U=a(127),H=a(130),J=a(116),Y=a(79),z=function(e){var t=e.v,a=e.g,r=e.p,o=e.c,c=e.children;return o||(o="p"),t||(t="body2"),n.a.createElement(Y.a,{variant:t,gutterBottom:a,paragraph:r,component:o},c)};function P(e){var t=e.children,a=e.value,r=e.index;return n.a.createElement("div",{role:"tabpanel",hidden:a!==r},a===r&&n.a.createElement(N.a,{p:3},n.a.createElement(z,{c:"span"},t)))}var q=Object(I.a)((function(e){return{root:{"z-index":"1000",position:"absolute",width:"400px",height:"450px",padding:"20px","align-items":"center",top:"50%",left:"50%","margin-top":"-225px","margin-left":"-200px"},box:{height:"450px"},tabs:{height:"50px"},content:{height:"400px","overflow-y":"auto"},input:{paddingBottom:"10px","text-align":"left"},alert:{"text-align":"left"}}})),M=Object(_.f)((function(e){var t=u(),a=Object(w.a)(t,2),o=a[0],c=o.login,i=o.register,s=a[1];Object(r.useEffect)((function(){c.isLogged&&e.closeLoginBar()}),[c.isLogged]);var l=Object(r.useState)(0),E=Object(w.a)(l,2),b=E[0],p=E[1];Object(r.useEffect)((function(){p(e.tab)}),[e.tab]);var f=Object(r.useState)({username:"",password:"",nickname:""}),S=Object(w.a)(f,2),C=S[0],v=S[1],j=function(e){v(Object(m.a)(Object(m.a)({},C),{},Object(F.a)({},e.target.name,e.target.value)))},y=q(),k=c.error.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{severity:"error",className:y.alert},n.a.createElement(J.a,null,"Login was unsuccessful"),c.error),n.a.createElement("br",null)),L=i.success&&n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{severity:"success",className:y.alert},"Registration was successful, you may now login."),n.a.createElement("br",null)),_=i.error.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement(H.a,{severity:"error",className:y.alert},n.a.createElement(J.a,null,"Registration was unsuccessful"),i.error),n.a.createElement("br",null));return console.log("did this rerender?"),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:y.root},n.a.createElement(G.a,{elevation:2,className:y.box},n.a.createElement(D.a,{indicatorColor:"primary",textColor:"primary",variant:"fullWidth",value:b,onChange:function(t,a){e.openCloseLoginBar(a),p(a)},className:y.tabs},n.a.createElement(B.a,{label:"Register",id:"0"}),n.a.createElement(B.a,{label:"Login",id:"1"})),n.a.createElement("center",{className:y.content},n.a.createElement(P,{value:b,index:0},L||_,n.a.createElement("form",null,n.a.createElement(U.a,{label:"Email",name:"username",type:"email",required:!0,variant:"outlined",className:y.input,onChange:j}),n.a.createElement("br",null),n.a.createElement(U.a,{label:"Nickname",name:"nickname",required:!0,variant:"outlined",className:y.input,onChange:j}),n.a.createElement("br",null),n.a.createElement(U.a,{label:"Password",name:"password",type:"password",required:!0,variant:"outlined",className:y.input,onChange:j}),n.a.createElement("br",null)),n.a.createElement(A.a,{variant:"contained",onClick:function(t){t.preventDefault();var a={email:C.username,password:C.password,nickname:C.nickname};!function(e,t){var a={method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(t)};fetch("/api/users",a).then((function(t){t.ok?e(h()):409===t.status?e(O("Register failed. Is username already in use?")):t.json().then((function(t){e(O("Server responded with status: ".concat(t.error)))})).catch((function(a){e(O("Server responded with status: ".concat(t.status)))}))})).catch((function(t){e(O("Server responded with status: ".concat(t)))}))}(s,a,e.history)}},"Register")),n.a.createElement(P,{value:b,index:1},k,n.a.createElement("form",null,n.a.createElement(U.a,{label:"Email",name:"username",type:"email",required:!0,variant:"outlined",className:y.input,onChange:j}),n.a.createElement("br",null),n.a.createElement(U.a,{label:"Password",name:"password",type:"password",required:!0,variant:"outlined",className:y.input,onChange:j}),n.a.createElement("br",null)),n.a.createElement(A.a,{variant:"contained",onClick:function(t){t.preventDefault();var a={email:C.username,password:C.password};!function(e,t,a){var r={method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(t)};fetch("/api/users/login",r).then((function(t){t.ok?t.json().then((function(t){console.log(t),e(g(t)),a.push("/")})).catch((function(t){e(d("Server responded with status: ".concat(t)))})):t.json().then((function(t){e(d("Server responded with status: ".concat(t.error)))})).catch((function(a){e(d("Server responded with status: ".concat(t.status)))}))})).catch((function(t){e(d("Server responded with status: ".concat(t)))}))}(s,a,e.history)}},"Log In"))))))})),W=Object(I.a)((function(e){return{toolbar:{backgroundColor:"white",borderBottom:"1px solid ".concat(e.palette.divider),position:"fixed",width:"auto",left:"40px",right:"40px"},ButtonGroup:{position:"absolute",right:"0px"}}})),V=Object(_.f)((function(e){var t=u(),a=Object(w.a)(t,2),o=a[0].login,c=a[1],i=Object(r.useState)({showLoginBar:!1,tab:1}),s=Object(w.a)(i,2),l=s[0],m=s[1],g=function(e){e===l.tab?m({showLoginBar:!l.showLoginBar,tab:e}):m({showLoginBar:!0,tab:e})},d=function(){m({showLoginBar:!1,tab:0})},p=W();return console.log("did this rerender?"),n.a.createElement(n.a.Fragment,null,n.a.createElement(x.a,{variant:"dense",className:p.toolbar},n.a.createElement("a",{href:"/",onClick:function(t){return a="/",t.preventDefault(),d(),void e.history.push(a);var a}},n.a.createElement("img",{src:"/TF_logo.gif"})),o.isLogged?n.a.createElement(R.a,{variant:"text",color:"inherit","aria-label":"text primary button group",className:p.ButtonGroup},n.a.createElement(A.a,{onClick:function(){return e.history.push("/")}},"Welcome ",o.user.nickname),n.a.createElement(A.a,{onClick:function(){!function(e,t){var a={method:"POST",mode:"cors",headers:{"Content-type":"application/json",Authorization:"bearer ".concat(t)}};fetch("/logout",a).then((function(t){e(E())})).catch((function(t){e(b("Server responded with an error: ".concat(t)))}))}(c,o.token)}},"Logout")):n.a.createElement(R.a,{variant:"text",color:"inherit","aria-label":"text primary button group",className:p.ButtonGroup},n.a.createElement(A.a,{onClick:function(){return g(0)}},"Register"),n.a.createElement(A.a,{onClick:function(){return g(1)}},"Login"))),l.showLoginBar&&n.a.createElement(M,{tab:l.tab,openCloseLoginBar:g,closeLoginBar:d}))})),K=a(122),Q=a(123),X=a(124),Z=a(121),$=a(120),ee=a(125),te=a(4),ae=Object(te.a)((function(e){return{head:{backgroundColor:e.palette.common.black,color:e.palette.common.white},body:{fontSize:14}}}))($.a),re=Object(te.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(Z.a),ne=Object(I.a)((function(e){return{root:{"text-decoration":"none",color:"inherit"}}})),oe=function(e){var t=e.item,a=t.categoryName,r=t.threads,o=t.id,c=t.description,i=ne();return n.a.createElement(re,null,n.a.createElement(ae,{component:"th",scope:"row"},n.a.createElement(z,{v:"h6"},n.a.createElement("a",{className:i.root,href:"/c/".concat(o),onClick:e.onClick},a)),c),n.a.createElement(ae,{size:"small",align:"center"},r?r.length:0),n.a.createElement(ae,null,"-"))},ce=Object(_.f)((function(e){var t=u(),a=Object(w.a)(t,2),o=a[0],c=o.login,i=o.category,s=a[1];Object(r.useEffect)((function(){!function(e,t){var a={method:"GET",mode:"cors",headers:{"Content-type":"application/json",Authorization:"bearer ".concat(t)}};fetch("/api/categories",a).then((function(t){t.ok?t.json().then((function(t){e(v(t))})).catch((function(t){e(j("Failed to parse data. Try again error ".concat(t)))})):403===t.status?(e(j("Server responded with a session failure. Logging out!")),e(E())):t.json().then((function(t){e(j("Server responded with status: ".concat(t.error)))})).catch((function(a){e(j("Server responded with status: ".concat(t.status)))}))})).catch((function(t){e(j("Server responded with an error: ".concat(t)))}))}(s,c.token)}),[]);var l=function(t){t.preventDefault(),e.history.push(t.target.getAttribute("href"))};console.log("did this rerender?");var m=i.categories.map((function(e){return n.a.createElement(oe,{key:e.id,item:e,onClick:l})}));return n.a.createElement(n.a.Fragment,null,n.a.createElement(K.a,null,n.a.createElement(Q.a,{"aria-label":"simple table"},n.a.createElement(X.a,null,n.a.createElement(Z.a,null,n.a.createElement($.a,null,"Category"),n.a.createElement($.a,{size:"small",align:"center"},"Threads"),n.a.createElement($.a,null,"Latests"))),n.a.createElement(ee.a,null,m))))})),ie=Object(_.f)((function(e){e.history,e.match;var t=u();Object(w.a)(t,1)[0].login;return console.log("did this rerender?"),n.a.createElement(n.a.Fragment,null,n.a.createElement(V,null),n.a.createElement(T.a,{maxWidth:"md",style:{paddingTop:"100px"}},n.a.createElement(_.c,null,n.a.createElement(_.a,{render:function(){return n.a.createElement(ce,null)}}))))}));c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(i.a,null,n.a.createElement(l,{initialState:L,reducer:function(e,t){var a=e.login,r=e.register,n=e.category;return{login:f(a,t),register:C(r,t),category:k(n,t)}}},n.a.createElement(ie,null)))),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.24254242.chunk.js.map