(this.webpackJsonptecnoforum=this.webpackJsonptecnoforum||[]).push([[0],{56:function(e,t,n){e.exports=n(66)},66:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),c=n.n(o),i=n(24),l=Object(r.createContext)(),u=function(e){var t=e.reducer,n=e.initialState,o=e.children;return a.a.createElement(l.Provider,{value:Object(r.useReducer)(t,n)},o)},s=function(){return Object(r.useContext)(l)},m=n(27),d=function(e){return{type:"LOGIN_SUCCESS",data:e}},g=function(e){return{type:"LOGIN_FAILED",error:e}},p=function(){return{type:"LOGOUT_SUCCESS"}},f=function(e){return{type:"LOGOUT_FAILED"}},h={token:"",user:{},isLogged:!1,error:""},E=function(e,t){switch(console.log("LoginReducer, action:",t),t.type){case"LOGIN_SUCCESS":return{isLogged:!0,token:t.data.token,user:t.data.user,error:"",loading:!1};case"LOGIN_FAILED":return Object(m.a)(Object(m.a)({},e),{},{error:t.error});case"LOGOUT_SUCCESS":return{isLogged:!1,token:"",user:{},error:""};case"LOGOUT_FAILED":return{isLogged:!1,token:"",user:{},error:t.error};default:return e}},b=function(){if(sessionStorage.getItem("mainstate")){var e=JSON.parse(sessionStorage.getItem("mainstate"));return e.login.error="",e}return{login:h}}(),O=n(22),S=n(10),v=n(108),L=n(103),j=n(104),y=n(68),C=n(105),x=(n(67),Object(L.a)((function(e){return{toolbar:{backgroundColor:"white",borderBottom:"1px solid ".concat(e.palette.divider),position:"fixed",width:"auto",left:"40px",right:"40px"},ButtonGroup:{position:"absolute",right:"0px"}}}))),w=Object(S.g)((function(e){var t=s(),n=Object(O.a)(t,2),r=n[0].login,o=n[1],c=x();return console.log("did this rerender?"),a.a.createElement(C.a,{variant:"dense",className:c.toolbar},a.a.createElement("img",{src:"/TF_logo.gif"}),r.isLogged?a.a.createElement(j.a,{variant:"text",color:"inherit","aria-label":"text primary button group",className:c.ButtonGroup},a.a.createElement(y.a,{onClick:function(){return e.history.push("/")}},"Welcome ",r.user.nickname),a.a.createElement(y.a,{onClick:function(){!function(e,t){var n={method:"POST",mode:"cors",headers:{"Content-type":"application/json",Authorization:"bearer ".concat(t)}};fetch("/logout",n).then((function(t){e(p())})).catch((function(t){e(f("Server responded with an error: ".concat(t)))}))}(o,r.token)}},"Logout")):a.a.createElement(j.a,{variant:"text",color:"inherit","aria-label":"text primary button group",className:c.ButtonGroup},a.a.createElement(y.a,{onClick:function(){return e.history.push("/register")}},"Register"),a.a.createElement(y.a,{onClick:function(){return e.history.push("/login")}},"Login")))})),k=n(34),N=n(106),I=n(109),G=n(110),_=n(107),F=Object(L.a)((function(e){return{root:{width:"fit-content",padding:"20px","align-items":"center"},input:{paddingBottom:"10px","text-align":"left"},alert:{"text-align":"left"}}})),T=Object(S.g)((function(e){var t=s(),n=Object(O.a)(t,2),o=n[0].login,c=n[1],i=Object(r.useState)({username:"",password:""}),l=Object(O.a)(i,2),u=l[0],p=l[1],f=function(e){p(Object(m.a)(Object(m.a)({},u),{},Object(k.a)({},e.target.name,e.target.value)))},h=F(),E=o.error.length>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement(G.a,{severity:"error",className:h.alert},a.a.createElement(_.a,null,"Login was unsuccessful"),o.error),a.a.createElement("br",null));return console.log("did this rerender?"),a.a.createElement(a.a.Fragment,null,a.a.createElement("center",null,a.a.createElement(N.a,{elevation:1,className:h.root},E,a.a.createElement("form",null,a.a.createElement(I.a,{label:"Email",name:"username",type:"email",required:!0,variant:"outlined",className:h.input,onChange:f}),a.a.createElement("br",null),a.a.createElement(I.a,{label:"Password",name:"password",type:"password",required:!0,variant:"outlined",className:h.input,onChange:f}),a.a.createElement("br",null)),a.a.createElement(y.a,{variant:"contained",onClick:function(t){t.preventDefault();var n={email:u.username,password:u.password};!function(e,t,n){var r={method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(t)};fetch("/api/users/login",r).then((function(t){t.ok?t.json().then((function(t){console.log(t),e(d(t)),n.push("/")})).catch((function(t){e(g("Server responded with status: ".concat(t)))})):t.json().then((function(t){e(g("Server responded with status: ".concat(t.error)))})).catch((function(n){e(g("Server responded with status: ".concat(t.status)))}))})).catch((function(t){e(g("Server responded with status: ".concat(t)))}))}(c,n,e.history)}},"Log In"))))})),U=Object(S.g)((function(e){e.history,e.match;var t=s(),n=Object(O.a)(t,1)[0].login;return console.log("did this rerender?"),a.a.createElement(a.a.Fragment,null,a.a.createElement(w,null),a.a.createElement(v.a,{maxWidth:"md",style:{paddingTop:"100px"}},a.a.createElement(S.d,null,a.a.createElement(S.b,{exact:!0,path:"/login/",render:function(){return n.isLogged?a.a.createElement(S.a,{to:"/"}):a.a.createElement(T,null)}}))))}));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(i.a,null,a.a.createElement(u,{initialState:b,reducer:function(e,t){var n=e.login,r={login:E(n,t)};return sessionStorage.setItem("mainstate",JSON.stringify(r)),r}},a.a.createElement(U,null)))),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.070256d2.chunk.js.map